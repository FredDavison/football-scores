#!/usr/bin/env python

import logging
import argparse
import datetime as dt

from footie_scores import utils
from footie_scores import db
from footie_scores.utils.log import start_logging
from footie_scores.db.queries import get_fixtures_by_date

logger = logging.getLogger(__name__)
start_logging()

date_context = {'today': utils.time.today(),
                'yesterday': utils.time.today() - dt.timedelta(days=1),
                'tomorrow': utils.time.today() + dt.timedelta(days=1),
}

def list_fixtures(date=utils.time.today()):
    utils.time.validate_date_str(date)
    with db.session_scope() as session:
        fixtures = get_fixtures_by_date(session, date)
        for fixture in fixtures:
            print(fixture)

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='List fixtures in db')
    parser.add_argument('-d', '--date', dest='date', default='today')
    args = parser.parse_args()
    date = date_context.get(args.date, args.date)
    list_fixtures(date)
